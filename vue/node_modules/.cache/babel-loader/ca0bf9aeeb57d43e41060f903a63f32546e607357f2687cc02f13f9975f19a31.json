{"ast":null,"code":"import NavBar from \"@/component/NavBar.vue\";\nexport default {\n  components: {\n    NavBar\n  },\n  data() {\n    let goodsId = this.$route.query.id;\n    return {\n      user: JSON.parse(localStorage.getItem(\"xm-user\") || \"{}\"),\n      goodsId: goodsId,\n      goodsData: {},\n      activeName: \"first\",\n      commentData: [],\n      quantity: 1\n    };\n  },\n  mounted() {\n    this.loadGoods();\n    this.loadComments();\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    loadGoods() {\n      this.$request.get(\"/goods/selectById?id=\" + this.goodsId).then(res => {\n        if (res.code === \"200\") {\n          this.goodsData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    handleClick(tab, event) {\n      this.activeName = tab.name;\n    },\n    collect() {\n      if (!this.user.id) {\n        this.$message.warning(\"请先登录\");\n        return;\n      }\n      let data = {\n        userId: this.user.id,\n        businessId: this.goodsData.businessId,\n        goodsId: this.goodsId\n      };\n      this.$request.post(\"/collect/add\", data).then(res => {\n        if (res.code === \"200\") {\n          this.$message.success(\"收藏成功\");\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    addCart() {\n      if (!this.user.id) {\n        this.$message.warning(\"请先登录\");\n        return;\n      }\n\n      // 检查库存\n      if (this.quantity > this.goodsData.stock) {\n        this.$message.error(`库存不足，当前库存: ${this.goodsData.stock}`);\n        return;\n      }\n      let data = {\n        num: 1,\n        userId: this.user.id,\n        goodsId: this.goodsId,\n        businessId: this.goodsData.businessId\n      };\n      this.$request.post(\"/cart/add\", data).then(res => {\n        if (res.code === \"200\") {\n          this.$message.success(\"已添加到购物车\");\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    navTo(url) {\n      location.href = url;\n    },\n    loadComments() {\n      this.$request.get(\"/comment/selectByGoodsId?id=\" + this.goodsId).then(res => {\n        if (res.code === \"200\") {\n          this.commentData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    }\n  }\n};","map":{"version":3,"names":["NavBar","components","data","goodsId","$route","query","id","user","JSON","parse","localStorage","getItem","goodsData","activeName","commentData","quantity","mounted","loadGoods","loadComments","methods","$request","get","then","res","code","$message","error","msg","handleClick","tab","event","name","collect","warning","userId","businessId","post","success","addCart","stock","num","navTo","url","location","href"],"sources":["src/views/front/Detail.vue"],"sourcesContent":["<template>\n  <div class=\"main-content\">\n    <nav-bar></nav-bar>\n\n    <div class=\"product-container\">\n      <div class=\"product-details\">\n        <el-row :gutter=\"20\">\n          <el-col :span=\"12\">\n            <div class=\"product-image-container\">\n              <img :src=\"goodsData.img\" alt=\"\" class=\"product-image\" />\n            </div>\n          </el-col>\n          <el-col :span=\"12\">\n            <div class=\"product-info\">\n              <h1 class=\"product-name\">{{ goodsData.name }}</h1>\n\n              <div class=\"product-meta\">\n                <div class=\"meta-item\">\n                  <i class=\"el-icon-shopping-cart-2\"></i>\n                  <span>销量: {{ goodsData.count || 0 }}</span>\n                </div>\n                <div\n                  class=\"meta-item stock-indicator\"\n                  :class=\"{ 'low-stock': goodsData.stock < 5 }\"\n                >\n                  <i class=\"el-icon-goods\"></i>\n                  <span>库存: {{ goodsData.stock || 0 }}</span>\n                  <span v-if=\"goodsData.stock < 10\" class=\"stock-warning\"\n                    >库存紧张</span\n                  >\n                </div>\n              </div>\n\n              <div class=\"product-price\">\n                <span class=\"price-label\">价格:</span>\n                <span class=\"price-value\"\n                  >¥{{ goodsData.price }} / {{ goodsData.unit }}</span\n                >\n              </div>\n\n              \n\n              <div class=\"product-tags\">\n                <div class=\"tag-item\">\n                  <span class=\"tag-label\">商家:</span>\n                  <a\n                    href=\"#\"\n                    @click=\"navTo('/front/business?id=' + goodsData.businessId)\"\n                    class=\"tag-link\"\n                  >\n                    {{ goodsData.businessName }}\n                  </a>\n                </div>\n                <div class=\"tag-item\">\n                  <span class=\"tag-label\">分类:</span>\n                  <a\n                    href=\"#\"\n                    @click=\"navTo('/front/type?id=' + goodsData.typeId)\"\n                    class=\"tag-link\"\n                  >\n                    {{ goodsData.typeName }}\n                  </a>\n                </div>\n              </div>\n\n              <div class=\"product-actions\">\n                <el-button\n                  type=\"primary\"\n                  icon=\"el-icon-shopping-cart-2\"\n                  @click=\"addCart\"\n                  >加入购物车</el-button\n                >\n                <el-button\n                  type=\"danger\"\n                  icon=\"el-icon-star-off\"\n                  @click=\"collect\"\n                  >收藏</el-button\n                >\n              </div>\n            </div>\n          </el-col>\n        </el-row>\n      </div>\n\n      <div class=\"product-tabs\">\n        <el-tabs v-model=\"activeName\" @tab-click=\"handleClick\">\n          <el-tab-pane label=\"商品详情\" name=\"first\">\n            <div\n              class=\"product-description\"\n              v-html=\"goodsData.description\"\n            ></div>\n          </el-tab-pane>\n          <el-tab-pane label=\"用户评价\" name=\"second\">\n            <div class=\"comment-section\">\n              <div\n                class=\"comment-item\"\n                v-for=\"(item, index) in commentData\"\n                :key=\"index\"\n              >\n                <div class=\"comment-header\">\n                  <div class=\"user-avatar\">\n                    <img :src=\"item.userAvatar\" alt=\"用户头像\" />\n                  </div>\n                  <div class=\"user-info\">\n                    <div class=\"user-name\">{{ item.userName }}</div>\n                    <div class=\"comment-time\">{{ item.time }}</div>\n                  </div>\n                </div>\n                <div class=\"comment-content\">\n                  {{ item.content }}\n                </div>\n              </div>\n              <div v-if=\"commentData.length === 0\" class=\"no-comments\">\n                暂无评价，购买后来做第一个评价吧~\n              </div>\n            </div>\n          </el-tab-pane>\n        </el-tabs>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport NavBar from \"@/component/NavBar.vue\";\n\nexport default {\n  components: {\n    NavBar,\n  },\n  data() {\n    let goodsId = this.$route.query.id;\n    return {\n      user: JSON.parse(localStorage.getItem(\"xm-user\") || \"{}\"),\n      goodsId: goodsId,\n      goodsData: {},\n      activeName: \"first\",\n      commentData: [],\n      quantity: 1,\n    };\n  },\n  mounted() {\n    this.loadGoods();\n    this.loadComments();\n  },\n  // methods：本页面所有的点击事件或者其他函数定义区\n  methods: {\n    loadGoods() {\n      this.$request.get(\"/goods/selectById?id=\" + this.goodsId).then((res) => {\n        if (res.code === \"200\") {\n          this.goodsData = res.data;\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    handleClick(tab, event) {\n      this.activeName = tab.name;\n    },\n    collect() {\n      if (!this.user.id) {\n        this.$message.warning(\"请先登录\");\n        return;\n      }\n\n      let data = {\n        userId: this.user.id,\n        businessId: this.goodsData.businessId,\n        goodsId: this.goodsId,\n      };\n      this.$request.post(\"/collect/add\", data).then((res) => {\n        if (res.code === \"200\") {\n          this.$message.success(\"收藏成功\");\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    addCart() {\n      if (!this.user.id) {\n        this.$message.warning(\"请先登录\");\n        return;\n      }\n\n      // 检查库存\n      if (this.quantity > this.goodsData.stock) {\n        this.$message.error(`库存不足，当前库存: ${this.goodsData.stock}`);\n        return;\n      }\n\n      let data = {\n        num: 1,\n        userId: this.user.id,\n        goodsId: this.goodsId,\n        businessId: this.goodsData.businessId,\n      };\n      this.$request.post(\"/cart/add\", data).then((res) => {\n        if (res.code === \"200\") {\n          this.$message.success(\"已添加到购物车\");\n        } else {\n          this.$message.error(res.msg);\n        }\n      });\n    },\n    navTo(url) {\n      location.href = url;\n    },\n    loadComments() {\n      this.$request\n        .get(\"/comment/selectByGoodsId?id=\" + this.goodsId)\n        .then((res) => {\n          if (res.code === \"200\") {\n            this.commentData = res.data;\n          } else {\n            this.$message.error(res.msg);\n          }\n        });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.main-content {\n  min-height: 100vh;\n  background-color: #f5f5f5;\n  padding-bottom: 40px;\n}\n\n.product-container {\n  width: 80%;\n  max-width: 1200px;\n  margin: 20px auto;\n  background-color: white;\n  border-radius: 12px;\n  box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  overflow: hidden;\n}\n\n.product-details {\n  padding: 24px;\n}\n\n.product-image-container {\n  width: 100%;\n  border-radius: 8px;\n  overflow: hidden;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\n}\n\n.product-image {\n  width: 100%;\n  height: 400px;\n  object-fit: cover;\n  transition: transform 0.3s;\n}\n\n.product-image:hover {\n  transform: scale(1.02);\n}\n\n.product-info {\n  padding: 0 16px;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n}\n\n.product-name {\n  font-size: 22px;\n  font-weight: bold;\n  margin: 0 0 16px 0;\n  line-height: 1.4;\n  color: #333;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  display: -webkit-box;\n  -webkit-line-clamp: 2;\n  -webkit-box-orient: vertical;\n}\n\n.product-meta {\n  display: flex;\n  flex-wrap: wrap;\n  margin-bottom: 16px;\n}\n\n.meta-item {\n  display: flex;\n  align-items: center;\n  margin-right: 24px;\n  margin-bottom: 8px;\n  color: #666;\n  font-size: 14px;\n}\n\n.meta-item i {\n  margin-right: 6px;\n  font-size: 16px;\n}\n\n.stock-indicator {\n  padding: 4px 8px;\n  border-radius: 4px;\n  background-color: #f0f9eb;\n  color: #67c23a;\n}\n\n.low-stock {\n  background-color: #fef0f0;\n  color: #f56c6c;\n}\n\n.stock-warning {\n  margin-left: 8px;\n  font-size: 12px;\n  background-color: #f56c6c;\n  color: white;\n  padding: 2px 6px;\n  border-radius: 4px;\n}\n\n.product-price {\n  margin: 16px 0;\n  padding: 12px;\n  background-color: #fff9f9;\n  border-radius: 6px;\n}\n\n.price-label {\n  font-size: 14px;\n  color: #666;\n  margin-right: 8px;\n}\n\n.price-value {\n  font-size: 24px;\n  font-weight: bold;\n  color: #f56c6c;\n}\n\n.product-promo {\n  margin: 16px 0;\n}\n\n.promo-image {\n  width: 100%;\n  max-height: 100px;\n  object-fit: cover;\n  border-radius: 6px;\n}\n\n.product-tags {\n  margin: 12px 0;\n}\n\n.tag-item {\n  margin-bottom: 8px;\n  font-size: 14px;\n}\n\n.tag-label {\n  color: #666;\n  margin-right: 8px;\n}\n\n.tag-link {\n  color: #409eff;\n  text-decoration: none;\n}\n\n.tag-link:hover {\n  text-decoration: underline;\n}\n\n.product-actions {\n  margin-top: 24px;\n  display: flex;\n  gap: 16px;\n}\n\n.product-tabs {\n  padding: 0 24px 24px;\n}\n\n.product-description {\n  padding: 20px;\n  line-height: 1.6;\n  color: #333;\n}\n\n.comment-section {\n  padding: 16px;\n}\n\n.comment-item {\n  padding: 16px;\n  border-bottom: 1px solid #eee;\n  margin-bottom: 16px;\n}\n\n.comment-header {\n  display: flex;\n  align-items: center;\n  margin-bottom: 12px;\n}\n\n.user-avatar {\n  width: 40px;\n  height: 40px;\n  border-radius: 50%;\n  overflow: hidden;\n  margin-right: 12px;\n}\n\n.user-avatar img {\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n}\n\n.user-info {\n  flex: 1;\n}\n\n.user-name {\n  font-weight: bold;\n  font-size: 16px;\n  color: #333;\n}\n\n.comment-time {\n  font-size: 12px;\n  color: #999;\n  margin-top: 4px;\n}\n\n.comment-content {\n  font-size: 14px;\n  line-height: 1.6;\n  color: #666;\n}\n\n.no-comments {\n  text-align: center;\n  padding: 30px;\n  color: #999;\n  font-size: 14px;\n}\n\n@media (max-width: 768px) {\n  .product-container {\n    width: 95%;\n  }\n\n  .product-actions {\n    flex-direction: column;\n  }\n}\n</style>"],"mappings":"AA4HA,OAAAA,MAAA;AAEA;EACAC,UAAA;IACAD;EACA;EACAE,KAAA;IACA,IAAAC,OAAA,QAAAC,MAAA,CAAAC,KAAA,CAAAC,EAAA;IACA;MACAC,IAAA,EAAAC,IAAA,CAAAC,KAAA,CAAAC,YAAA,CAAAC,OAAA;MACAR,OAAA,EAAAA,OAAA;MACAS,SAAA;MACAC,UAAA;MACAC,WAAA;MACAC,QAAA;IACA;EACA;EACAC,QAAA;IACA,KAAAC,SAAA;IACA,KAAAC,YAAA;EACA;EACA;EACAC,OAAA;IACAF,UAAA;MACA,KAAAG,QAAA,CAAAC,GAAA,gCAAAlB,OAAA,EAAAmB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAZ,SAAA,GAAAW,GAAA,CAAArB,IAAA;QACA;UACA,KAAAuB,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAC,YAAAC,GAAA,EAAAC,KAAA;MACA,KAAAjB,UAAA,GAAAgB,GAAA,CAAAE,IAAA;IACA;IACAC,QAAA;MACA,UAAAzB,IAAA,CAAAD,EAAA;QACA,KAAAmB,QAAA,CAAAQ,OAAA;QACA;MACA;MAEA,IAAA/B,IAAA;QACAgC,MAAA,OAAA3B,IAAA,CAAAD,EAAA;QACA6B,UAAA,OAAAvB,SAAA,CAAAuB,UAAA;QACAhC,OAAA,OAAAA;MACA;MACA,KAAAiB,QAAA,CAAAgB,IAAA,iBAAAlC,IAAA,EAAAoB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAY,OAAA;QACA;UACA,KAAAZ,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAW,QAAA;MACA,UAAA/B,IAAA,CAAAD,EAAA;QACA,KAAAmB,QAAA,CAAAQ,OAAA;QACA;MACA;;MAEA;MACA,SAAAlB,QAAA,QAAAH,SAAA,CAAA2B,KAAA;QACA,KAAAd,QAAA,CAAAC,KAAA,oBAAAd,SAAA,CAAA2B,KAAA;QACA;MACA;MAEA,IAAArC,IAAA;QACAsC,GAAA;QACAN,MAAA,OAAA3B,IAAA,CAAAD,EAAA;QACAH,OAAA,OAAAA,OAAA;QACAgC,UAAA,OAAAvB,SAAA,CAAAuB;MACA;MACA,KAAAf,QAAA,CAAAgB,IAAA,cAAAlC,IAAA,EAAAoB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAC,QAAA,CAAAY,OAAA;QACA;UACA,KAAAZ,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;IACAc,MAAAC,GAAA;MACAC,QAAA,CAAAC,IAAA,GAAAF,GAAA;IACA;IACAxB,aAAA;MACA,KAAAE,QAAA,CACAC,GAAA,uCAAAlB,OAAA,EACAmB,IAAA,CAAAC,GAAA;QACA,IAAAA,GAAA,CAAAC,IAAA;UACA,KAAAV,WAAA,GAAAS,GAAA,CAAArB,IAAA;QACA;UACA,KAAAuB,QAAA,CAAAC,KAAA,CAAAH,GAAA,CAAAI,GAAA;QACA;MACA;IACA;EACA;AACA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}